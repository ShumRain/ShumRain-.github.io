(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{46:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p",[t._v("在上篇文章《作用域》提到了执行上下文(Execution Contexts)，以及变量对象(variable object)和作用域链(scope chain)。")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("将一个数组模拟成 EC 栈：")]),t._v(" "),t._m(6),t._m(7),t._v(" "),a("p",[t._v("可执行代码有三种，分别是全局代码、函数代码、eval代码（这里不做讨论）。")]),t._v(" "),t._m(8),t._v(" "),a("p",[t._v("全局代码是不被包含在函数内的代码。当执行全局代码时，会创建全局 EC 。")]),t._v(" "),t._m(9),a("p",[t._v("进栈后，其中的全局代码才会开始执行。")]),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("在全局代码被执行时，如果遇到函数，则会再创建一个 EC , 被 push 到 ECStack。")]),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),a("p",[t._v("每一段函数代码执行完毕，该 EC 就会退出 ECStack，最终只剩下全局 EC，全局 EC在程序结束时（浏览器关闭）也会退出栈。")]),t._v(" "),t._m(14),t._v(" "),t._m(15),a("p",[t._v("a，b，foo()，都是全局代码，当遇到这一段代码时，创建全局 EC ，全局 EC 进栈。")]),t._v(" "),t._m(16),a("p",[t._v("执行全局 EC 中的代码，当执行到 foo() 时，函数 foo 创建新的 EC")]),t._v(" "),t._m(17),a("p",[t._v("然后开始执行 foo 中的函数代码，当遇到 bar() 后，又会新建一个 EC")]),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),a("p",[t._v("以此类推，程序关闭时，全局 EC 出栈。")]),t._v(" "),t._m(21),t._v(" "),a("p",[t._v("每个执行上下文都有三个重要属性：")]),t._v(" "),t._m(22),t._v(" "),a("p",[t._v("将会在之后的文章中详细描写。而其中的变量对象是 ES3 的说法，在 ES5 中换了个说法。")]),t._v(" "),t._m(23),t._v(" "),a("p",[t._v("需要注意的时，执行上下文和作用域看似相似，但是还是有明显区别。")]),t._v(" "),a("p",[t._v("作用域在词法解析阶段就已经确定了，而执行上下文是在执行时才创建的。")]),t._v(" "),a("p",[t._v("作用域主要是区分变量的作用范围，而执行上下文主要是规范可执行代码的执行顺序。")]),t._v(" "),t._m(24),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Execution Contexts"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://github.com/mqyqingfeng/Blog/issues/4",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript深入之执行上下文栈"),a("OutboundLink")],1)])])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("js 代码整个执行过程分为代码编译阶段和代码执行阶段。在编译阶段确定作用域，执行阶创建"),s("strong",[this._v("执行上下文")]),this._v("。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("当查找变量时，会先从当前"),s("strong",[this._v("执行上下文")]),this._v("的"),s("strong",[this._v("变量对象")]),this._v("中查找。如果没有找到，就会从父级执行上下文的变量对象中查找，以及父级的父级直到全局执行上下文的变量对象，也就是全局对象。这样由多个执行上下文的"),s("strong",[this._v("变量对象")]),this._v("构成的链表就是作用域链。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("个人认为context翻译成上下文有点不好理解，环境还会更容易理解，此文的用简写"),s("code",[this._v("EC")]),this._v("表示。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"定义"}},[this._v("定义 "),s("a",{staticClass:"header-anchor",attrs:{href:"#定义","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("When control is transferred to ECMAScript executable code, control is entering an "),s("em",[this._v("execution context")]),this._v(". Active execution contexts logically form a stack. The top execution context on this logical stack is the running execution context.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("js 编译阶段时会把代码编译成一段一段的可执行代码。当控制器遇到"),s("strong",[this._v("可执行代码")]),this._v("就会创建"),s("code",[this._v("EC")]),this._v("，由 js 引擎实现。在程序运行时，可能会产生多个 EC，这些 EC 会被保存在栈中，栈底永远是全局 EC ，而栈顶是当前的 EC，执行完毕后出栈。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[this._v("ECStack "),s("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v(" "),s("span",{attrs:{class:"token punctuation"}},[this._v("[")]),s("span",{attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"可执行代码"}},[this._v("可执行代码 "),s("a",{staticClass:"header-anchor",attrs:{href:"#可执行代码","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"全局代码"}},[this._v("全局代码 "),s("a",{staticClass:"header-anchor",attrs:{href:"#全局代码","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[this._v("ECStack "),s("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v(" "),s("span",{attrs:{class:"token punctuation"}},[this._v("[")]),this._v("\n  GlobalContext\n"),s("span",{attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"函数代码"}},[this._v("函数代码 "),s("a",{staticClass:"header-anchor",attrs:{href:"#函数代码","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[this._v("ECStack "),s("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v(" "),s("span",{attrs:{class:"token punctuation"}},[this._v("[")]),this._v("\n  FunctionContext\n  GlobalContext\n"),s("span",{attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("FunctionContext")]),this._v("被创建后，开始执行其中的函数代码。如果其中还有函数，又会再创建 EC，以此类推，多个 EC 会形成一个执行栈。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("ECStack "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("FunctionContext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("4")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("FunctionContext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("FunctionContext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("FunctionContext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  GlobalContext\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"举个例子"}},[this._v("举个例子 "),s("a",{staticClass:"header-anchor",attrs:{href:"#举个例子","aria-hidden":"true"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" c "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),t._v("\n\n\tfucntion "),a("span",{attrs:{class:"token function"}},[t._v("bar")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" d "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("4")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),a("span",{attrs:{class:"token function"}},[t._v("bar")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token function"}},[t._v("foo")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[this._v("ECStack "),s("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v(" "),s("span",{attrs:{class:"token punctuation"}},[this._v("[")]),this._v("\n  globaclContext \n"),s("span",{attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[this._v("ECStack "),s("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v(" "),s("span",{attrs:{class:"token punctuation"}},[this._v("[")]),this._v("\n  foo FunctionContext\n  globaclContext \n"),s("span",{attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("ECStack "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("bar"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" FunctionContext\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("foo"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" FunctionContext\n  globaclContext \n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这时执行 bar 中的代码，当 bar 中的代码执行完毕时，"),s("code",[this._v("<bar> FunctionContext")]),this._v("出栈")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("ECStack "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("foo"),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" FunctionContext\n  globaclContext \n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"后记"}},[this._v("后记 "),s("a",{staticClass:"header-anchor",attrs:{href:"#后记","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("变量对象(variable object)")]),this._v(" "),s("li",[this._v("作用域链(Scope chain)")]),this._v(" "),s("li",[this._v("this")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[this._v("总结 "),s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"参考阅读"}},[this._v("参考阅读 "),s("a",{staticClass:"header-anchor",attrs:{href:"#参考阅读","aria-hidden":"true"}})])}],!1,null,null,null);s.default=e.exports}}]);